@page "/"
@layout LoginLayout

@using Microsoft.AspNetCore.Components.Forms
@using AccreditValidation.Shared.Models.Authentication

<div id="login_form_container">
    <EditForm Model="@userLoginModel" OnValidSubmit="HandleLoginAsync">
        <div class="full-height-container">

            <!-- Logo (tap to reveal site name) -->
            <div id="login_logo_holder" class="text-center" @onclick="ToggleSiteNameVisibility" style="cursor: pointer;">
                <img src="Images/logo.png" alt="App Logo" id="login-image-logo" />
            </div>

            <!-- Credentials card -->
            <div class="login-card">
                <div class="login-card-header">
                    <span class="card-icon">🔒</span>
                    @LocalizationService["Login"]
                </div>

                <!-- Site name (hidden until logo tapped) -->
                @if (isSiteNameVisible)
                {
                    <div class="row-divider"></div>
                    <div class="login-field-row">
                        <label class="form-label">@LocalizationService["SiteName"]</label>
                        <InputText class="form-control" @bind-Value="userLoginModel.SiteName" />
                    </div>
                }

                <div class="row-divider"></div>
                <div class="login-field-row">
                    <label class="form-label">@LocalizationService["Username"]</label>
                    <InputText class="form-control" @bind-Value="userLoginModel.Username" />
                </div>

                <div class="row-divider"></div>
                <div class="login-field-row">
                    <label class="form-label">@LocalizationService["Password"]</label>
                    <InputText class="form-control" type="password" @bind-Value="userLoginModel.Password" />
                </div>
            </div>

            <!-- Language card -->
            <div class="login-card">
                <div class="login-card-header">
                    <span class="card-icon">🌐</span>
                    @LocalizationService["Language"]
                </div>
                <div class="row-divider"></div>
                <div class="login-field-row">
                    <select class="language-picker" @onchange="OnLanguageChanged">
                        @foreach (var language in LanguageList)
                        {
                            <option value="@language.LanguageCode">
                                @LanguageStateService.GetFlagEmoji(language.LanguageCode) @language.LanguageName
                            </option>
                        }
                    </select>
                </div>
            </div>

            <!-- Options row: remember-me + forgot password -->
            <div id="login_options_holder">
                <div class="form-check">
                    <InputCheckbox class="form-check-input" @bind-Value="userLoginModel.RememberMe" />
                    <label class="form-check-label">@LocalizationService["RememberMe"]</label>
                </div>
                <a href="#" class="login-link">@LocalizationService["ForgotPassword"]</a>
            </div>

            <!-- Submit -->
            <button class="btn-login" type="submit">
                @LocalizationService["Login"]
            </button>

        </div>
    </EditForm>
</div>
