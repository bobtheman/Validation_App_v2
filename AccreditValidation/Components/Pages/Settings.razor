@page "/Settings"
@using Components

<AuthWrapper>
    <div class="settings-container">

        <!-- ── Security ──────────────────────────────────────────────────────── -->
        @if (ShowFingerPrintOption)
        {
            <div class="settings-card">
                <div class="settings-card-header">
                    <i class="bi bi-shield-lock card-icon"></i>
                    <span>@LocalizationService["Security"]</span>
                </div>

                <div class="toggle-row">
                    <div class="toggle-label-group">
                        <i class="bi bi-fingerprint toggle-icon"></i>
                        <span class="toggle-label">@LocalizationService["UseFingerprint"]</span>
                    </div>
                    <label class="switch">
                        <input type="checkbox" @bind="UseFingerprint" />
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
        }

        <!-- ── Language ──────────────────────────────────────────────────────── -->
        <div class="settings-card">
            <div class="settings-card-header">
                <i class="bi bi-translate card-icon"></i>
                <span>@LocalizationService["Language"]</span>
            </div>
            <select class="settings-select" @onchange="OnLanguageChanged">
                @foreach (var language in LanguageList)
                {
                    <option value="@language.LanguageCode"
                            selected="@(AppState.SelectedLanguageCode == language.LanguageCode ? "selected" : null)">
                        @LanguageStateService.GetFlagEmoji(language.LanguageCode) @language.LanguageName
                    </option>
                }
            </select>
        </div>

        <!-- ── Input Options ─────────────────────────────────────────────────── -->
        <div class="settings-card">
            <div class="settings-card-header">
                <i class="bi bi-keyboard card-icon"></i>
                <span>@LocalizationService["InputOptions"]</span>
            </div>
            @if (ShowNfcOption)
            { 
                <div class="toggle-row">
                    <div class="toggle-label-group">
                        <i class="bi bi-wifi toggle-icon"></i>
                        <span class="toggle-label">@LocalizationService["UseNfc"]</span>
                    </div>
                    <label class="switch">
                        <input type="checkbox" @bind="UseNfc" />
                        <span class="slider"></span>
                    </label>
                </div>
                <div class="row-divider"></div>
            }
            <select class="settings-select" @onchange="OnInputOptionChanged">
                @foreach (var input in InputOptionList)
                {
                    <option value="@input.InputOptionCode"
                            selected="@(AppState.SelectedInputOptionCode == input.InputOptionCode ? "selected" : null)">
                        @input.InputOptionName
                    </option>
                }
            </select>
        </div>

        <!-- ── Application ───────────────────────────────────────────────────── -->
        <div class="settings-card">
            <div class="settings-card-header">
                <i class="bi bi-grid card-icon"></i>
                <span>@LocalizationService["Application"]</span>
            </div>

            <button class="btn-link-row" @onclick="Home">
                <i class="bi bi-house btn-link-icon"></i>
                <span>@LocalizationService["HomePage"]</span>
                <i class="bi bi-chevron-right btn-link-chevron"></i>
            </button>

            <div class="row-divider"></div>

            <button class="btn-link-row" @onclick="Feedback">
                <i class="bi bi-chat-dots btn-link-icon"></i>
                <span>@LocalizationService["Feedback"]</span>
                <i class="bi bi-chevron-right btn-link-chevron"></i>
            </button>

            <div class="row-divider"></div>

            <button class="btn-danger-row" @onclick="ResetApplication">
                <i class="bi bi-arrow-counterclockwise"></i>
                <span>@LocalizationService["ResetApplication"]</span>
            </button>
        </div>

        <!-- ── Logout ─────────────────────────────────────────────────────────── -->
        <div class="logout-wrapper">
            <button class="btn-logout" @onclick="Logout">
                <i class="bi bi-box-arrow-right"></i>
                @LocalizationService["Logout"]
            </button>
        </div>

        <!-- ── Version ───────────────────────────────────────────────────────── -->
        <div class="footer-text">@LocalizationService["AppVersion"]: @AppVersion</div>

    </div>

    <!-- ── Confirm Reset Dialog ───────────────────────────────────────────── -->
    @if (showConfirmResetApplicationDialog)
    {
        <div class="modal-overlay">
            <div class="modal-window">
                <h2 class="modal-title">@LocalizationService["ConfirmPrompt"]</h2>
                <p class="modal-message">@LocalizationService["ResetMessage"]</p>
                <div class="modal-actions">
                    <button class="modal-btn modal-btn-cancel" @onclick="() => ConfirmResetApplication(false)">@LocalizationService["Cancel"]</button>
                    <button class="modal-btn modal-btn-confirm" @onclick="() => ConfirmResetApplication(true)">@LocalizationService["OK"]</button>
                </div>
            </div>
        </div>
    }

    <!-- ── Confirm Logout Dialog ──────────────────────────────────────────── -->
    @if (showConfirmLogoutDialog)
    {
        <div class="modal-overlay">
            <div class="modal-window">
                <h2 class="modal-title">@LocalizationService["ConfirmPrompt"]</h2>
                <p class="modal-message">@LocalizationService["LogoutMessage"]</p>
                <div class="modal-actions">
                    <button class="modal-btn modal-btn-cancel" @onclick="() => ConfirmLogout(false)">@LocalizationService["Cancel"]</button>
                    <button class="modal-btn modal-btn-confirm" @onclick="() => ConfirmLogout(true)">@LocalizationService["OK"]</button>
                </div>
            </div>
        </div>
    }

</AuthWrapper>
